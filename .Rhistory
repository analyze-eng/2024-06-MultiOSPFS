## Pick NAA11
gene<-rna["ATP1A2",mm]
df  <-na.omit(data.frame(dat3,x=scale(gene))) # much smaller
ssA<-sshzd(Surv(tend,event=="prog", start=tstart)~tend*x,
data=df,subset=df$last=="(s0)",
seed=609)
ssC<-sshzd(Surv(tend,event=="died", start=tstart)~tend*x,
data=df,subset=df$last=="prog",
seed=609)
ssC<-sshzd(Surv(tend,event=="died", start=tstart)~tend*x,
data=df,subset=df$last=="(s0)",
seed=609)
## make 3 plots
nx<-40;nt<-50
ranx<-range(scale(gene),na.rm=TRUE)
grid.x<-seq(from=ranx[1],to=ranx[2],length=nx)
grid.t<-seq(from=0,to=100,length=nt)
xy<-expand.grid(tend=grid.t,x=grid.x)
mm<-lapply(list(ssA,ssB,ssC),hzdrate.sshzd,x=xy)
mm<-lapply(mm,matrix,ncol=nx,nrow=nt)
lab<-c("ANED->AWD","AWD->DEAD","ANED->DEAD")
zlim<-range(unlist(mm),na.rm=TRUE)
col<-c(hcl.colors(50),colorRampPalette(c(hcl.colors(2)[2],"red"))(50))
par(mfrow=c(1,3))
for(k in 1:3){
image(grid.t,grid.x,mm[[k]],main=lab[k],col=col,
zlim=zlim)
}
## make 3 plots
nx<-40;nt<-50
ranx<-range(scale(gene),na.rm=TRUE)
grid.x<-seq(from=ranx[1],to=ranx[2],length=nx)
grid.t<-seq(from=0,to=100,length=nt)
xy<-expand.grid(tend=grid.t,x=grid.x)
mm<-lapply(list(ssA,ssB,ssC),hzdrate.sshzd,x=xy)
mm<-lapply(mm,matrix,ncol=nx,nrow=nt)
lab<-c("ANED->AWD","AWD->DEAD","ANED->DEAD")
zlim<-range(unlist(mm),na.rm=TRUE)
col<-c(hcl.colors(50),colorRampPalette(c(hcl.colors(2)[2],"red"))(50))
par(mfrow=c(1,3))
for(k in 1:3){
image(grid.t,grid.x,log(mm[[k]]),main=lab[k],col=col,
zlim=zlim)
}
## make 3 plots
nx<-40;nt<-50
ranx<-range(scale(gene),na.rm=TRUE)
grid.x<-seq(from=ranx[1],to=ranx[2],length=nx)
grid.t<-seq(from=0,to=100,length=nt)
xy<-expand.grid(tend=grid.t,x=grid.x)
mm<-lapply(list(ssA,ssB,ssC),hzdrate.sshzd,x=xy)
mm<-lapply(mm,matrix,ncol=nx,nrow=nt)
lab<-c("ANED->AWD","AWD->DEAD","ANED->DEAD")
zlim<-range(log(unlist(mm)),na.rm=TRUE)
col<-c(hcl.colors(50),colorRampPalette(c(hcl.colors(2)[2],"red"))(50))
par(mfrow=c(1,3))
for(k in 1:3){
image(grid.t,grid.x,log(mm[[k]]),main=lab[k],col=col,
zlim=zlim)
}
## make 3 plots
nx<-40;nt<-50
ranx<-range(scale(gene),na.rm=TRUE)
grid.x<-seq(from=ranx[1],to=ranx[2],length=nx)
grid.t<-seq(from=0,to=100,length=nt)
xy<-expand.grid(tend=grid.t,x=grid.x)
mm<-lapply(list(ssA,ssB,ssC),hzdrate.sshzd,x=xy)
mm<-lapply(mm,matrix,ncol=nx,nrow=nt)
mm<-lapply(mm,log)
lab<-c("ANED->AWD","AWD->DEAD","ANED->DEAD")
zlim<-range(unlist(mm),na.rm=TRUE)
col<-c(hcl.colors(50),colorRampPalette(c(hcl.colors(2)[2],"red"))(50))
par(mfrow=c(1,3))
for(k in 1:3){
image(grid.t,grid.x,mm[[k]],main=lab[k],col=col,
zlim=zlim)
}
## set up RNA alignment, I don't feel like copying
## a big rna data frame around, so I call it
## when I need it
mm<-match(dat3$id,colnames(rna))
## Pick NAA11; has interesting 1st plot
## Pick ATP1A2; has interesting last plot
gene<-rna["C7orf52",mm]
df  <-na.omit(data.frame(dat3,x=scale(gene))) # much smaller
ssA<-sshzd(Surv(tend,event=="prog", start=tstart)~tend*x,
data=df,subset=df$last=="(s0)",
seed=609)
ssC<-sshzd(Surv(tend,event=="died", start=tstart)~tend*x,
data=df,subset=df$last=="prog",
seed=609)
ssC<-sshzd(Surv(tend,event=="died", start=tstart)~tend*x,
data=df,subset=df$last=="(s0)",
seed=609)
gene<-rna["foo",]
df1<-data1;df1$time<-df1$time1;df1$x<-gene
sort(p1[5,])
head(sort(p1[5,]))
gene<-rna["ANXA8",]
df1<-data1;df1$time<-df1$time1;df1$x<-gene
ss1<-sshzd(Surv(time,event1)~time*x,
data=df1,seed=609)
gene<-rna["ANXA8",]
df1<-data1;df1$time<-df1$time1;df1$x<-scale(gene)
ss1<-sshzd(Surv(time,event1)~time*x,
data=df1,seed=609)
df1$x
df1$time
gene<-rna["ANXA8",]
df1<-data1;df1$time<-df1$time1;df1$x<-scale(gene)
ss1<-sshzd(Surv(time,event1)~time*x,
data=df1,seed=609)
df1$x
df1
ss1<-sshzd(Surv(time1,event1)~time*x,
data=df1,seed=609)
ss1<-sshzd(Surv(time1,event1)~time1*x,
data=df1,seed=609)
df1<-data1;df1$time<-df1$time1;df1$x<-as.numeric(scale(gene))
ss1<-sshzd(Surv(time1,event1)~time1*x,
data=df1,seed=609)
gene<-rna["ANXA8",]
df1<-data1;df1$time<-df1$time1;df1$x<-as.numeric(scale(gene))
ss1<-sshzd(Surv(time,event1)~time*x,
data=df1,seed=609)
df2<-df1;df2$time<-df2$time2
ss2<-sshzd(Surv(time,event2)~time*x,
data=df2,seed=609)
## make 2 plots
nx<-40;nt<-50
ranx<-range(scale(gene),na.rm=TRUE)
grid.x<-seq(from=ranx[1],to=ranx[2],length=nx)
grid.t<-seq(from=0,to=100,length=nt)
xy<-expand.grid(time=grid.t,x=grid.x)
mm<-lapply(list(ss1,ss2),hzdrate.sshzd,x=xy)
mm<-lapply(mm,matrix,ncol=nx,nrow=nt)
lab<-c("Hazard of Death","Hazard for Death/Progression")
zlim<-range(unlist(mm),na.rm=TRUE)
col<-c(hcl.colors(50),colorRampPalette(c(hcl.colors(2)[2],"red"))(50))
par(mfrow=c(1,2))
for(k in 1:2){
image(grid.t,grid.x,mm[[k]],main=lab[k],col=col,
zlim=zlim)
}
## make 2 plots
nx<-40;nt<-50
ranx<-range(scale(gene),na.rm=TRUE)
grid.x<-seq(from=ranx[1],to=ranx[2],length=nx)
grid.t<-seq(from=0,to=100,length=nt)
xy<-expand.grid(time=grid.t,x=grid.x)
mm<-lapply(list(ss1,ss2),hzdrate.sshzd,x=xy)
mm<-lapply(mm,matrix,ncol=nx,nrow=nt)
mm<-lapply(mm,log)
lab<-c("Hazard of Death","Hazard for Death/Progression")
zlim<-range(unlist(mm),na.rm=TRUE)
col<-c(hcl.colors(50),colorRampPalette(c(hcl.colors(2)[2],"red"))(50))
par(mfrow=c(1,2))
for(k in 1:2){
image(grid.t,grid.x,mm[[k]],main=lab[k],col=col,
zlim=zlim)
}
sort(p2[5,])
head(sort(p2[5,]))
gene<-rna["ADAM6",]
df1<-data1;df1$time<-df1$time1;df1$x<-as.numeric(scale(gene))
ss1<-sshzd(Surv(time,event1)~time*x,
data=df1,seed=609)
df2<-df1;df2$time<-df2$time2
ss2<-sshzd(Surv(time,event2)~time*x,
data=df2,seed=609)
## make 2 plots
nx<-40;nt<-50
ranx<-range(scale(gene),na.rm=TRUE)
grid.x<-seq(from=ranx[1],to=ranx[2],length=nx)
grid.t<-seq(from=0,to=100,length=nt)
xy<-expand.grid(time=grid.t,x=grid.x)
mm<-lapply(list(ss1,ss2),hzdrate.sshzd,x=xy)
mm<-lapply(mm,matrix,ncol=nx,nrow=nt)
mm<-lapply(mm,log)
lab<-c("Hazard of Death","Hazard for Death/Progression")
zlim<-range(unlist(mm),na.rm=TRUE)
col<-c(hcl.colors(50),colorRampPalette(c(hcl.colors(2)[2],"red"))(50))
par(mfrow=c(1,2))
for(k in 1:2){
image(grid.t,grid.x,mm[[k]],main=lab[k],col=col,
zlim=zlim,
xlab="Months from Surgery",
ylab="Baseline Expression")
contour(grid.t,grid.x,mm[[k]],add=TRUE)
}
head(sort(p2[5,]))
## "ADAM6" has an okay pattern
##
gene<-rna["AMPD1",]
df1<-data1;df1$time<-df1$time1;df1$x<-as.numeric(scale(gene))
ss1<-sshzd(Surv(time,event1)~time*x,
data=df1,seed=609)
df2<-df1;df2$time<-df2$time2
ss2<-sshzd(Surv(time,event2)~time*x,
data=df2,seed=609)
## make 2 plots
nx<-40;nt<-50
ranx<-range(scale(gene),na.rm=TRUE)
grid.x<-seq(from=ranx[1],to=ranx[2],length=nx)
grid.t<-seq(from=0,to=100,length=nt)
xy<-expand.grid(time=grid.t,x=grid.x)
mm<-lapply(list(ss1,ss2),hzdrate.sshzd,x=xy)
mm<-lapply(mm,matrix,ncol=nx,nrow=nt)
mm<-lapply(mm,log)
lab<-c("Hazard of Death","Hazard for Death/Progression")
zlim<-range(unlist(mm),na.rm=TRUE)
col<-c(hcl.colors(50),colorRampPalette(c(hcl.colors(2)[2],"red"))(50))
par(mfrow=c(1,2))
for(k in 1:2){
image(grid.t,grid.x,mm[[k]],main=lab[k],col=col,
zlim=zlim,
xlab="Months from Surgery",
ylab="Baseline Expression")
contour(grid.t,grid.x,mm[[k]],add=TRUE)
}
head(sort(p2[5,]))
## "ADAM6" has an okay pattern
## "AMPD1" simliar
gene<-rna["IGJ",]
df1<-data1;df1$time<-df1$time1;df1$x<-as.numeric(scale(gene))
ss1<-sshzd(Surv(time,event1)~time*x,
data=df1,seed=609)
df2<-df1;df2$time<-df2$time2
ss2<-sshzd(Surv(time,event2)~time*x,
data=df2,seed=609)
## make 2 plots
nx<-40;nt<-50
ranx<-range(scale(gene),na.rm=TRUE)
grid.x<-seq(from=ranx[1],to=ranx[2],length=nx)
grid.t<-seq(from=0,to=100,length=nt)
xy<-expand.grid(time=grid.t,x=grid.x)
mm<-lapply(list(ss1,ss2),hzdrate.sshzd,x=xy)
mm<-lapply(mm,matrix,ncol=nx,nrow=nt)
mm<-lapply(mm,log)
lab<-c("Hazard of Death","Hazard for Death/Progression")
zlim<-range(unlist(mm),na.rm=TRUE)
col<-c(hcl.colors(50),colorRampPalette(c(hcl.colors(2)[2],"red"))(50))
par(mfrow=c(1,2))
for(k in 1:2){
image(grid.t,grid.x,mm[[k]],main=lab[k],col=col,
zlim=zlim,
xlab="Months from Surgery",
ylab="Baseline Expression")
contour(grid.t,grid.x,mm[[k]],add=TRUE)
}
## set up RNA alignment, I don't feel like copying
## a big rna data frame around, so I call it
## when I need it
mm<-match(dat3$id,colnames(rna))
## Pick NAA11; has interesting 1st plot
## Pick ATP1A2; has interesting last plot
gene<-rna["C7orf52",mm]
df  <-na.omit(data.frame(dat3,x=scale(gene))) # much smaller
ssA<-sshzd(Surv(tend,event=="prog", start=tstart)~tend*x,
data=df,subset=df$last=="(s0)",
seed=609)
ssC<-sshzd(Surv(tend,event=="died", start=tstart)~tend*x,
data=df,subset=df$last=="prog",
seed=609)
ssC<-sshzd(Surv(tend,event=="died", start=tstart)~tend*x,
data=df,subset=df$last=="(s0)",
seed=609)
## make 3 plots
nx<-40;nt<-50
ranx<-range(scale(gene),na.rm=TRUE)
grid.x<-seq(from=ranx[1],to=ranx[2],length=nx)
grid.t<-seq(from=0,to=100,length=nt)
xy<-expand.grid(tend=grid.t,x=grid.x)
mm<-lapply(list(ssA,ssB,ssC),hzdrate.sshzd,x=xy)
mm<-lapply(mm,matrix,ncol=nx,nrow=nt)
mm<-lapply(mm,log)
lab<-c("ANED->AWD","AWD->DEAD","ANED->DEAD")
zlim<-range(unlist(mm),na.rm=TRUE)
col<-c(hcl.colors(50),colorRampPalette(c(hcl.colors(2)[2],"red"))(50))
par(mfrow=c(1,3))
for(k in 1:3){
image(grid.t,grid.x,mm[[k]],main=lab[k],col=col,
zlim=zlim,
xlab="Months from Surgery",
ylab="Baseline Expression")
contour(grid.t,grid.x,mm[[k]],add=TRUE)
}
head(rev(sort((pC[1,]-pB[1,])^2)))
## set up RNA alignment, I don't feel like copying
## a big rna data frame around, so I call it
## when I need it
mm<-match(dat3$id,colnames(rna))
## Pick NAA11; has interesting 1st plot
## Pick ATP1A2; has interesting last plot
## SAA1
## IP6K3
gene<-rna["SAA1",mm]
df  <-na.omit(data.frame(dat3,x=scale(gene))) # much smaller
ssA<-sshzd(Surv(tend,event=="prog", start=tstart)~tend*x,
data=df,subset=df$last=="(s0)",
seed=609)
ssC<-sshzd(Surv(tend,event=="died", start=tstart)~tend*x,
data=df,subset=df$last=="prog",
seed=609)
ssC<-sshzd(Surv(tend,event=="died", start=tstart)~tend*x,
data=df,subset=df$last=="(s0)",
seed=609)
## make 3 plots
nx<-40;nt<-50
ranx<-range(scale(gene),na.rm=TRUE)
grid.x<-seq(from=ranx[1],to=ranx[2],length=nx)
grid.t<-seq(from=0,to=100,length=nt)
xy<-expand.grid(tend=grid.t,x=grid.x)
mm<-lapply(list(ssA,ssB,ssC),hzdrate.sshzd,x=xy)
mm<-lapply(mm,matrix,ncol=nx,nrow=nt)
mm<-lapply(mm,log)
lab<-c("ANED->AWD","AWD->DEAD","ANED->DEAD")
zlim<-range(unlist(mm),na.rm=TRUE)
col<-c(hcl.colors(50),colorRampPalette(c(hcl.colors(2)[2],"red"))(50))
par(mfrow=c(1,3))
for(k in 1:3){
image(grid.t,grid.x,mm[[k]],main=lab[k],col=col,
zlim=zlim,
xlab="Months from Surgery",
ylab="Baseline Expression")
contour(grid.t,grid.x,mm[[k]],add=TRUE)
}
## set up RNA alignment, I don't feel like copying
## a big rna data frame around, so I call it
## when I need it
mm<-match(dat3$id,colnames(rna))
## Pick NAA11; has interesting 1st plot
## Pick ATP1A2; has interesting last plot
## SAA1: Good baseline. Shows progression specific
## IP6K3
gene<-rna["IP6K3",mm]
df  <-na.omit(data.frame(dat3,x=scale(gene))) # much smaller
ssA<-sshzd(Surv(tend,event=="prog", start=tstart)~tend*x,
data=df,subset=df$last=="(s0)",
seed=609)
ssC<-sshzd(Surv(tend,event=="died", start=tstart)~tend*x,
data=df,subset=df$last=="prog",
seed=609)
ssC<-sshzd(Surv(tend,event=="died", start=tstart)~tend*x,
data=df,subset=df$last=="(s0)",
seed=609)
## make 3 plots
nx<-40;nt<-50
ranx<-range(scale(gene),na.rm=TRUE)
grid.x<-seq(from=ranx[1],to=ranx[2],length=nx)
grid.t<-seq(from=0,to=100,length=nt)
xy<-expand.grid(tend=grid.t,x=grid.x)
mm<-lapply(list(ssA,ssB,ssC),hzdrate.sshzd,x=xy)
mm<-lapply(mm,matrix,ncol=nx,nrow=nt)
mm<-lapply(mm,log)
lab<-c("ANED->AWD","AWD->DEAD","ANED->DEAD")
zlim<-range(unlist(mm),na.rm=TRUE)
col<-c(hcl.colors(50),colorRampPalette(c(hcl.colors(2)[2],"red"))(50))
par(mfrow=c(1,3))
for(k in 1:3){
image(grid.t,grid.x,mm[[k]],main=lab[k],col=col,
zlim=zlim,
xlab="Months from Surgery",
ylab="Baseline Expression")
contour(grid.t,grid.x,mm[[k]],add=TRUE)
}
head(rev(sort((pA[1,]-pC[1,])^2)))
head(rev(sort((pB[1,]-pC[1,])^2)))
## Pick NAA11; has interesting 1st plot
## Pick ATP1A2; has interesting last plot
## SAA1: Good baseline. Shows progression specific
gene<-rna["IP6K3",mm]
## set up RNA alignment, I don't feel like copying
## a big rna data frame around, so I call it
## when I need it
mm<-match(dat3$id,colnames(rna))
## Pick NAA11; has interesting 1st plot
## Pick ATP1A2; has interesting last plot
## SAA1: Good baseline. Shows progression specific
## PI3, GSTA1
gene<-rna["PI3",mm]
df  <-na.omit(data.frame(dat3,x=scale(gene))) # much smaller
ssA<-sshzd(Surv(tend,event=="prog", start=tstart)~tend*x,
data=df,subset=df$last=="(s0)",
seed=609)
ssC<-sshzd(Surv(tend,event=="died", start=tstart)~tend*x,
data=df,subset=df$last=="prog",
seed=609)
ssC<-sshzd(Surv(tend,event=="died", start=tstart)~tend*x,
data=df,subset=df$last=="(s0)",
seed=609)
## make 3 plots
nx<-40;nt<-50
ranx<-range(scale(gene),na.rm=TRUE)
grid.x<-seq(from=ranx[1],to=ranx[2],length=nx)
grid.t<-seq(from=0,to=100,length=nt)
xy<-expand.grid(tend=grid.t,x=grid.x)
mm<-lapply(list(ssA,ssB,ssC),hzdrate.sshzd,x=xy)
mm<-lapply(mm,matrix,ncol=nx,nrow=nt)
mm<-lapply(mm,log)
lab<-c("ANED->AWD","AWD->DEAD","ANED->DEAD")
zlim<-range(unlist(mm),na.rm=TRUE)
col<-c(hcl.colors(50),colorRampPalette(c(hcl.colors(2)[2],"red"))(50))
par(mfrow=c(1,3))
for(k in 1:3){
image(grid.t,grid.x,mm[[k]],main=lab[k],col=col,
zlim=zlim,
xlab="Months from Surgery",
ylab="Baseline Expression")
contour(grid.t,grid.x,mm[[k]],add=TRUE)
}
## set up RNA alignment, I don't feel like copying
## a big rna data frame around, so I call it
## when I need it
mm<-match(dat3$id,colnames(rna))
## Pick NAA11; has interesting 1st plot
## Pick ATP1A2; has interesting last plot
## SAA1: Good baseline. Shows progression specific
## PI3, interesting first and last, but not enough gradient
## GSTA1
gene<-rna["GSTA1",mm]
df  <-na.omit(data.frame(dat3,x=scale(gene))) # much smaller
ssA<-sshzd(Surv(tend,event=="prog", start=tstart)~tend*x,
data=df,subset=df$last=="(s0)",
seed=609)
ssC<-sshzd(Surv(tend,event=="died", start=tstart)~tend*x,
data=df,subset=df$last=="prog",
seed=609)
ssC<-sshzd(Surv(tend,event=="died", start=tstart)~tend*x,
data=df,subset=df$last=="(s0)",
seed=609)
## make 3 plots
nx<-40;nt<-50
ranx<-range(scale(gene),na.rm=TRUE)
grid.x<-seq(from=ranx[1],to=ranx[2],length=nx)
grid.t<-seq(from=0,to=100,length=nt)
xy<-expand.grid(tend=grid.t,x=grid.x)
mm<-lapply(list(ssA,ssB,ssC),hzdrate.sshzd,x=xy)
mm<-lapply(mm,matrix,ncol=nx,nrow=nt)
mm<-lapply(mm,log)
lab<-c("ANED->AWD","AWD->DEAD","ANED->DEAD")
zlim<-range(unlist(mm),na.rm=TRUE)
col<-c(hcl.colors(50),colorRampPalette(c(hcl.colors(2)[2],"red"))(50))
par(mfrow=c(1,3))
for(k in 1:3){
image(grid.t,grid.x,mm[[k]],main=lab[k],col=col,
zlim=zlim,
xlab="Months from Surgery",
ylab="Baseline Expression")
contour(grid.t,grid.x,mm[[k]],add=TRUE)
}
## make 3 plots
nx<-40;nt<-50
ranx<-range(scale(gene),na.rm=TRUE)
grid.x<-seq(from=ranx[1],to=ranx[2],length=nx)
grid.t<-seq(from=0,to=100,length=nt)
xy<-expand.grid(tend=grid.t,x=grid.x)
mm<-lapply(list(ssA,ssB,ssC),hzdrate.sshzd,x=xy)
mm<-lapply(mm,matrix,ncol=nx,nrow=nt)
#mm<-lapply(mm,log)
lab<-c("ANED->AWD","AWD->DEAD","ANED->DEAD")
zlim<-range(unlist(mm),na.rm=TRUE)
col<-c(hcl.colors(50),colorRampPalette(c(hcl.colors(2)[2],"red"))(50))
par(mfrow=c(1,3))
for(k in 1:3){
image(grid.t,grid.x,mm[[k]],main=lab[k],col=col,
zlim=zlim,
xlab="Months from Surgery",
ylab="Baseline Expression")
contour(grid.t,grid.x,mm[[k]],add=TRUE)
}
head(rev(sort((pA[1,]-pB[1,])^2)))
## set up RNA alignment, I don't feel like copying
## a big rna data frame around, so I call it
## when I need it
mm<-match(dat3$id,colnames(rna))
## Pick NAA11; has interesting 1st plot
## Pick ATP1A2; has interesting last plot
## SAA1: Good baseline. Shows progression specific
## PI3, interesting first and last, but not enough gradient
## GSTA1
gene<-rna["PRSS33",mm]
df  <-na.omit(data.frame(dat3,x=scale(gene))) # much smaller
ssA<-sshzd(Surv(tend,event=="prog", start=tstart)~tend*x,
data=df,subset=df$last=="(s0)",
seed=609)
ssC<-sshzd(Surv(tend,event=="died", start=tstart)~tend*x,
data=df,subset=df$last=="prog",
seed=609)
ssC<-sshzd(Surv(tend,event=="died", start=tstart)~tend*x,
data=df,subset=df$last=="(s0)",
seed=609)
## make 3 plots
nx<-40;nt<-50
ranx<-range(scale(gene),na.rm=TRUE)
grid.x<-seq(from=ranx[1],to=ranx[2],length=nx)
grid.t<-seq(from=0,to=100,length=nt)
xy<-expand.grid(tend=grid.t,x=grid.x)
mm<-lapply(list(ssA,ssB,ssC),hzdrate.sshzd,x=xy)
mm<-lapply(mm,matrix,ncol=nx,nrow=nt)
#mm<-lapply(mm,log)
lab<-c("ANED->AWD","AWD->DEAD","ANED->DEAD")
zlim<-range(unlist(mm),na.rm=TRUE)
col<-c(hcl.colors(50),colorRampPalette(c(hcl.colors(2)[2],"red"))(50))
par(mfrow=c(1,3))
for(k in 1:3){
image(grid.t,grid.x,mm[[k]],main=lab[k],col=col,
zlim=zlim,
xlab="Months from Surgery",
ylab="Baseline Expression")
contour(grid.t,grid.x,mm[[k]],add=TRUE)
}
